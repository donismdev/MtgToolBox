<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>MtgToolBox</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
	<style>
		body {
			font-family: sans-serif;
			margin: 0;
		}
		#sidebar {
			width: 250px;
			background: #f8f9fa;
			padding: 1rem;
			border-right: 1px solid #ddd;
			height: 100vh;
			overflow-y: auto;
			position: fixed;
		}
		#content {
			margin-left: 250px;
			padding: 2rem;
		}
		#ad-container {
			margin-top: 2rem;
			padding-top: 1rem;
			border-top: 1px solid #ccc;
		}
		#ad-container iframe {
			width: 100%;
			height: 120px;
			border: none;
		}
		#ad-warning {
			font-size: 0.875rem;
			color: #888;
			margin-top: 0.5rem;
			text-align: center;
		}
	</style>
</head>
<body>
	<div class="d-flex">
		<div id="sidebar">
			<h4>MtgToolBox</h4>
			<hr>
			<ul class="nav nav-pills flex-column mb-auto" id="tool-list"></ul>
		</div>
		<div id="content" class="flex-grow-1">
			<h1 class="display-5">툴을 선택해주세요</h1>
			<p class="lead">왼쪽 사이드바에서 툴을 선택하여 시작하세요.</p>
		</div>
	</div>

	<script>
		const toolIndexUrl = "tool_index.json";
		const toolList = document.getElementById("tool-list");
		const content = document.getElementById("content");

		function renderTool(tool) {
			let html = `
				<div class="card mb-3">
					<div class="card-header">
						<h2 class="card-title mb-0" title="${tool.description}">${tool.name}</h2>
					</div>
				</div>
			`;

			if (tool.type === "html") {
				const htmlPath = `${tool.path}${tool.name}.html`;
				html += `<iframe src="${htmlPath}" class="w-100 border-0" style="height:600px;"></iframe>`;
			} else {
				html += `<form id="toolForm">`;

				if (tool.inputs && Array.isArray(tool.inputs)) {
					tool.inputs.forEach(input => {
						html += `
							<div class="mb-3">
								<label for="${input.id}" class="form-label">${input.label}</label>
								<input type="${input.type}" class="form-control" id="${input.id}"
									${input.accept ? `accept="${input.accept}"` : ""}
									${input.default ? `value="${input.default}"` : ""}
								>
							</div>
						`;
					});
				}
				html += `</form>`;

				if (tool.path && tool.name && tool.download) {
					const zipPath = `${tool.path}${tool.name}.zip`;
					html += `<a href="${zipPath}" class="btn btn-primary" download>
						<i class="bi bi-download"></i> 다운로드 (.zip)
					 </a>`;
				}
			}

			// 광고 영역 및 안내문구 추가
			html += `
				<div id="ad-container">
					<iframe src="https://ads-partner.example.com/your-ad-code"></iframe>
					<div class="notice text-center" style="font-size:0.9em; color:#555; margin-top:1rem;">
						  이 페이지에는 쿠팡 파트너스 활동의 일환으로, 광고 링크가 포함되어 있으며, 이에 따른 수수료를 제공받을 수 있습니다.
					</div>
				</div>
			`;

			content.innerHTML = html;
		}

		fetch(toolIndexUrl)
			.then(res => res.json())
			.then(data => {
				data.tools.forEach(tool => {
					const item = document.createElement("li");
					item.className = "nav-item";
					const link = document.createElement("a");
					link.href = "#";
					link.className = "nav-link link-dark";
					link.textContent = tool.name;
					link.onclick = (e) => {
						e.preventDefault();
						renderTool(tool);
					};
					item.appendChild(link);
					toolList.appendChild(item);
				});
			});
	</script>
</body>
</html>
