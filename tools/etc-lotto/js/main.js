let rollBtn=document.getElementById("rollBtn"),resultsContainer=document.getElementById("lotto-results"),settingsPanel=document.getElementById("settingsPanel"),toggleSettingsBtn=document.getElementById("toggleSettingsBtn"),isAnimating=!1,skipAnimation=!1,confettiInterval=null,sleep=t=>new Promise(e=>setTimeout(e,t));function getISOWeek(e){var t=new Date(e.valueOf()),e=(e.getDay()+6)%7,e=(t.setDate(t.getDate()-e+3),new Date(t.getFullYear(),0,4));return 1+Math.round(((t-e)/864e5-3+(e.getDay()+6)%7)/7)}function getSeed(e){if(!document.getElementById("useDateSeed").checked)return`${Math.random()}-${e.max}-`+(new Date).getTime();var t=new Date;let n;return`${t.getFullYear()}-W${n=document.getElementById("useISOSeed").checked?getISOWeek(t):t.getMonth()+1+"-"+Math.ceil(t.getDate()/7)}-${e.max}-${e.min}-`+e.count}function seededRandom(t){let n=1779033703^t.length;for(let e=0;e<t.length;e++)n=(n=Math.imul(n^t.charCodeAt(e),3432918353))<<13|n>>>19;return function(){return n=Math.imul(n^n>>>16,2246822507),n=Math.imul(n^n>>>13,3266489909),((n^=n>>>16)>>>0)/4294967296}}function generateLottoNumbers(t){var n=getSeed(t),a=[];for(let e=0;e<t.sets;e++){for(var i=new Set,l=seededRandom(n+("-set"+e));i.size<t.count;){var r=Math.floor(l()*(t.max-t.min+1))+t.min;i.add(r)}a.push(Array.from(i).sort((e,t)=>e-t))}return a}async function displayNumbers(e){rollBtn.disabled=!0,isAnimating=!0;let t=0;for(let n=0;n<e.length;n++){let a=document.createElement("div");a.className="lotto-set",resultsContainer.appendChild(a);let i=e[n];for(let e=0;e<i.length;e++){if(skipAnimation){let t=document.createElement("div");t.className="lotto-number",t.textContent=i[e],a.appendChild(t)}else{let l=document.createElement("div");l.className="lotto-number",a.appendChild(l);let s=setInterval(()=>{l.textContent=Math.floor(Math.random()*parseInt(document.getElementById("maxVal").value))+1},50);await sleep(100),clearInterval(s),l.textContent=i[e],l.style.transform="scale(1.1)",await sleep(50),l.style.transform="scale(1)",t++}}n===e.length-1&&!skipAnimation&&confetti({particleCount:150,spread:180,origin:{y:.6}}),!skipAnimation&&a.classList.add("flash"),await sleep(200)}rollBtn.disabled=!1,isAnimating=!1}function runLottery(){if(isAnimating)return;let e={min:parseInt(document.getElementById("minVal").value),max:parseInt(document.getElementById("maxVal").value),count:parseInt(document.getElementById("countVal").value),sets:parseInt(document.getElementById("setsVal").value)};e.min>=e.max||e.count<1||e.sets<1||(resultsContainer.innerHTML="",displayNumbers(generateLottoNumbers(e)))}rollBtn.addEventListener("click",()=>{skipAnimation=!1,runLottery()}),toggleSettingsBtn.addEventListener("click",()=>{settingsPanel.classList.toggle("show")}),document.addEventListener("DOMContentLoaded",()=>{settingsPanel.classList.remove("show")});