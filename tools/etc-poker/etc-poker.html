<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <title data-i18n-key="title">랜덤 포커 패 생성기</title>
    <script>
        // Apply theme on initial load BEFORE tailwind script runs
        try {
            const savedMode = localStorage.getItem('darkMode');
            if (savedMode && JSON.parse(savedMode)) {
                document.documentElement.classList.add('dark');
            }
        } catch (e) { /* ignore */ }
    </script>
    <script>
      window.tailwind = window.tailwind || {};
      window.tailwind.config = {
        darkMode: 'class',
        theme: {
            extend: {
                fontFamily: {
                    'gowun': ['Gowun Dodum', 'sans-serif'],
                },
            },
        },
      }
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&display=swap" rel="stylesheet">
    <script>
        window.i18n = {
            lang: localStorage.getItem('selectedLanguage') || 'ko',
            translations: {},
            initPromise: null,
            _resolveInit: null,
            init() {
                this.initPromise = new Promise(resolve => { this._resolveInit = resolve; });
                (async () => {
                    try {
                        const response = await fetch('../../assets/i18n/language.json');
                        if (!response.ok) throw new Error('Network response was not ok');
                        const data = await response.json();
                        this.translations = data.translations;
                        this.apply();
                    } catch (error) {
                        console.error('Failed to load translations:', error);
                    } finally {
                        this._resolveInit();
                    }
                })();
            },
            t(key, replacements = {}) {
                const translation = this.translations['etc-poker']?.[key]?.[this.lang];
                if (!translation) return key;
                let result = translation;
                for (const placeholder in replacements) {
                    result = result.replace(`{${placeholder}}`, replacements[placeholder]);
                }
                return result;
            },
            apply() {
                document.querySelectorAll('[data-i18n-key]').forEach(el => {
                    el.textContent = this.t(el.dataset.i18nKey);
                });
            }
        };
        window.i18n.init();
        // Theme listener for dynamic changes from parent window
        window.addEventListener('message', (event) => {
            if (event.data.theme) {
                if (event.data.theme === 'dark') {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
            }
        });
    </script>
    <style>
        .card { transform-style: preserve-3d; }
        .card.is-flipped { transform: translateY(0) rotateY(0deg); }
        .card .back { transform: rotateY(180deg); }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 flex justify-center items-center min-h-screen p-2 box-border font-gowun">
    <div class="game-container w-full max-w-2xl text-center bg-teal-900 dark:bg-gray-800 p-10 rounded-2xl border-8 border-yellow-800 shadow-2xl">
        <h1 class="text-4xl font-bold text-yellow-400 mb-8" data-i18n-key="title">랜덤 포커 패 생성기</h1>
        <div id="cards" class="flex justify-center items-center flex-wrap min-h-[150px] mb-8"></div>
        <div id="result" class="text-3xl font-bold min-h-[80px] text-white opacity-0 transition-opacity duration-1000 ease-in-out mb-8"></div>
        <button id="dealBtn" data-i18n-key="dealCards" class="text-white font-bold py-4 px-8 rounded-lg text-xl shadow-md transition transform hover:-translate-y-1 disabled:bg-gray-500 disabled:cursor-not-allowed disabled:transform-none bg-blue-600 hover:bg-blue-500">카드 받기</button>
    </div>
    <script src="js/main.js"></script>
</body>
</html>