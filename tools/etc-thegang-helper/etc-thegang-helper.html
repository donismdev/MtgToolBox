<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>더 갱 툴</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<style>
		body {
			background-color: #121212;
			color: #fff;
			padding: 1rem;
			font-family: 'Segoe UI', sans-serif;
		}
		.card-list { display: flex; flex-wrap: wrap; gap: 0.5rem; }
		.card-tag {
			background-color: #222;
			padding: 0.5rem 0.75rem;
			border-radius: 0.5rem;
			border: 1px solid #555;
			cursor: pointer;
			position: relative;
		}
		.card-tag.penalty { border-color: #dc3545; }
		.card-tag.advantage { border-color: #0d6efd; }
		.card-tag .remove-btn {
			position: absolute;
			top: -8px;
			right: -8px;
			background: #ff4d4d;
			border: none;
			color: white;
			border-radius: 50%;
			width: 20px;
			height: 20px;
			font-size: 12px;
			line-height: 20px;
			text-align: center;
			padding: 0;
			cursor: pointer;
		}
	</style>
</head>
<body>
	<h2 class="mb-4">💼 더 갱 게임 툴</h2>

	<div class="mb-3">
		<h4>📊 작전 성공/실패 상태</h4>
		<div class="form-check form-switch">
			<input class="form-check-input" type="checkbox" id="scoreModeToggle" onchange="toggleScoreMode()">
			<label class="form-check-label" for="scoreModeToggle">점수제 모드 사용</label>
		</div>
		<div id="tokenMode">
			<p>금고 카드: <span id="safeCount">0</span> / 3</p>
			<p>경보 카드: <span id="alertCount">0</span> / 3</p>
			<button class="btn btn-success btn-sm" onclick="addSafe()">+ 금고</button>
			<button class="btn btn-danger btn-sm" onclick="addAlert()">+ 경보</button>
		</div>
		<div id="scoreMode" style="display:none">
			<p>점수: <span id="score">0</span></p>
			<button class="btn btn-primary btn-sm" onclick="addScore(1)">+1 성공</button>
			<button class="btn btn-warning btn-sm" onclick="addScore(-1)">-1 실패</button>
		</div>
		<button class="btn btn-outline-light btn-sm mt-2" onclick="resetStatus()">초기화</button>
	</div>

	<div class="mb-4">
		<h4>❗ 패널티 카드</h4>
		<select id="penaltySelect" class="form-select mb-2">
		</select>
		<div class="d-flex gap-2">
			<button class="btn btn-outline-danger btn-sm" onclick="addRandomCard('penalty')">랜덤 추가</button>
			<button class="btn btn-danger btn-sm" onclick="addSelectedCard('penalty')">선택 추가</button>
		</div>
		<div class="card-list mt-2" id="penaltyList"></div>
	</div>

	<div class="mb-4">
		<h4>🎁 어드밴티지 카드</h4>
		<select id="advantageSelect" class="form-select mb-2">
		</select>
		<div class="d-flex gap-2">
			<button class="btn btn-outline-primary btn-sm" onclick="addRandomCard('advantage')">랜덤 추가</button>
			<button class="btn btn-primary btn-sm" onclick="addSelectedCard('advantage')">선택 추가</button>
		</div>
		<div class="card-list mt-2" id="advantageList"></div>
	</div>

	<div class="modal fade" id="cardModal" tabindex="-1">
		<div class="modal-dialog">
			<div class="modal-content bg-dark text-white">
				<div class="modal-header">
					<h5 class="modal-title">카드 상세 보기</h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<p id="cardDetail"></p>
				</div>
			</div>
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script>
		const penaltyCards = [
			{ id: 1, name: '불운의 예감', text: '작전 성공 시 카드가 2장 추가된다.' },
			{ id: 2, name: '도청기 발견', text: '최종 라운드에서 공개 순서가 바뀐다.' },
			{ id: 3, name: '헛다리', text: '추측 등수를 바꿀 수 없다.' },
			{ id: 4, name: '의심의 눈초리', text: '이전 라운드 정보를 공유할 수 없다.' },
			{ id: 5, name: '함정 카드', text: '작전 성공 시에도 어드밴티지 카드가 추가된다.' },
			{ id: 6, name: '경보음', text: '공개 시 1명을 제외하고 순위를 바꿔야 한다.' },
			{ id: 7, name: '금고함 오류', text: '금고 카드 1장이 무효가 된다.' },
			{ id: 8, name: '뒤바뀐 위치', text: '예상한 등수와 반대의 등수가 된다.' },
			{ id: 9, name: '기밀 노출', text: '모든 어드밴티지 카드의 효과가 무효화된다.' },
			{ id: 10, name: '추가 경보', text: '경보 카드가 1장 즉시 추가된다.' }
		];
		const advantageCards = [
			{ id: 1, name: '작전회의', text: '모든 플레이어는 예상 등수를 1명씩 공유할 수 있다.' },
			{ id: 2, name: '운명의 동전', text: '추측 등수를 한 번 다시 바꿀 수 있다.' },
			{ id: 3, name: '힌트 획득', text: '특정 플레이어의 순위를 힌트로 받는다.' },
			{ id: 4, name: '팀워크', text: '2명 이상 성공 시 금고 카드가 2장 추가된다.' },
			{ id: 5, name: '정신집중', text: '자신의 예상 등수를 재검토할 수 있다.' },
			{ id: 6, name: '정보 공유', text: '플랍 이후 힌트를 추가로 공개한다.' },
			{ id: 7, name: '보안 강화', text: '경보 카드 효과가 1회 무효화된다.' },
			{ id: 8, name: '도움의 손길', text: '한 명의 예상 등수를 대신 정해줄 수 있다.' },
			{ id: 9, name: '시간 벌기', text: '라운드 타이머를 30초 연장한다.' },
			{ id: 10, name: '의외의 행운', text: '작전 실패 시에도 금고 카드 1장을 획득한다.' }
		];

		function populateSelects() {
			const makeOptions = (arr) => arr.map(card => `<option value="${card.id}">#${card.id} ${card.name}</option>`).join('');
			document.getElementById('penaltySelect').innerHTML = makeOptions(penaltyCards);
			document.getElementById('advantageSelect').innerHTML = makeOptions(advantageCards);
		}

		let safe = 0, alert = 0, score = 0;
		function addSafe() { if (safe < 3) document.getElementById('safeCount').textContent = ++safe; }
		function addAlert() { if (alert < 3) document.getElementById('alertCount').textContent = ++alert; }
		function addScore(delta) { score += delta; document.getElementById('score').textContent = score; }
		function toggleScoreMode() {
			const scoreMode = document.getElementById('scoreModeToggle').checked;
			document.getElementById('scoreMode').style.display = scoreMode ? 'block' : 'none';
			document.getElementById('tokenMode').style.display = scoreMode ? 'none' : 'block';
		}
		function resetStatus() {
			safe = alert = score = 0;
			document.getElementById('safeCount').textContent = safe;
			document.getElementById('alertCount').textContent = alert;
			document.getElementById('score').textContent = score;
			document.getElementById('penaltyList').innerHTML = '';
			document.getElementById('advantageList').innerHTML = '';
		}
		function addRandomCard(type) {
			const arr = (type === 'penalty') ? penaltyCards : advantageCards;
			const card = arr[Math.floor(Math.random() * arr.length)];
			addCardToUI(type, card);
		}
		function addSelectedCard(type) {
			const select = document.getElementById(type + 'Select');
			const id = parseInt(select.value);
			const card = (type === 'penalty' ? penaltyCards : advantageCards).find(c => c.id === id);
			if (card) addCardToUI(type, card);
		}
		function addCardToUI(type, card) {
			const tag = document.createElement('div');
			tag.className = `card-tag ${type}`;
			tag.innerHTML = `#${card.id} ${card.name} 🔍 <button class="remove-btn" onclick="this.parentNode.remove(); event.stopPropagation();">×</button>`;
			tag.onclick = () => showCardDetail(card);
			document.getElementById(type + 'List').appendChild(tag);
		}
		function showCardDetail(card) {
			document.getElementById('cardDetail').textContent = `#${card.id} ${card.name} - ${card.text}`;
			const modal = new bootstrap.Modal(document.getElementById('cardModal'));
			modal.show();
		}
		document.addEventListener('DOMContentLoaded', populateSelects);
	</script>
</body>
</html>