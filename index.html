<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>MtgToolBox</title>
	<style>
		body {
			font-family: sans-serif;
			margin: 0;
			display: flex;
			min-height: 100vh;
		}

		#sidebar {
			width: 250px;
			background: #f3f3f3;
			border-right: 1px solid #ccc;
			overflow-y: auto;
			transition: transform 0.3s ease;
			flex-shrink: 0;
		}

		#content {
			flex: 1;
			padding: 20px;
			transition: all 0.3s ease;
		}

		.tool-link {
			display: block;
			padding: 10px;
			cursor: pointer;
			border-bottom: 1px solid #ddd;
		}

		.tool-link:hover {
			background: #eee;
		}

		#toggleBtn {
			position: fixed;
			top: 10px;
			left: 250px;
			z-index: 999;
			background: #ccc;
			border: none;
			cursor: pointer;
			padding: 5px;
			transition: left 0.3s ease;
		}

		/* ✅ 사이드바 숨김 */
		.sidebar-hidden #sidebar {
			display: none;
		}

		.sidebar-hidden #content {
			width: 100%;
		}

		.sidebar-hidden #toggleBtn {
			left: 0;
		}

		form label {
			display: block;
			margin-top: 1em;
		}

		form input {
			width: 100%;
			padding: 4px;
			margin-top: 4px;
		}
	</style>

</head>
<body>
	<div id="sidebar"></div>
	<button id="toggleBtn">&lt;-&gt;</button>
	<div id="content">
		<h1>툴을 선택해주세요</h1>
	</div>

	<script>
		function version() {
		return "1.0.0";
		}
		function printVersion() {
			console.log("도구 모음 버전: " + version());
		}
		printVersion();

		const toolIndexUrl = "tool_index.json";
		const sidebar = document.getElementById("sidebar");
		const content = document.getElementById("content");

		document.getElementById("toggleBtn").addEventListener("click", () => {
			document.body.classList.toggle("sidebar-hidden");
		});

		function renderTool(tool) {
			if (tool.type === "html") {
				const htmlPath = `${tool.path}${tool.name}.html`;
				content.innerHTML = `<iframe src="${htmlPath}" style="width: 100%; height: 90vh; border: none;"></iframe>`;
				return;
			}

			let html = `<h2>${tool.name}</h2><p>${tool.description}</p>`;

			if (tool.inputs && Array.isArray(tool.inputs)) {
				html += `<form id="toolForm">`;
				tool.inputs.forEach(input => {
					html += `
						<label>${input.label}
							<input type="${input.type}" 
								id="${input.id}" 
								${input.accept ? `accept="${input.accept}"` : ""}
								${input.default ? `value="${input.default}"` : ""}
							/>
						</label>
					`;
				});
				html += `</form>`;
			}

			if (tool.path && tool.name && tool.download) {
				const zipPath = `${tool.path}${tool.name}.zip`;
				html += `<p><a href="${zipPath}" download>📦 다운로드 (.zip)</a></p>`;
			}

			content.innerHTML = html;
		}

		fetch(toolIndexUrl)
			.then(res => res.json())
			.then(data => {
				data.tools.forEach(tool => {
					const item = document.createElement("div");
					item.className = "tool-link";
					item.textContent = tool.name;
					item.onclick = () => renderTool(tool);
					sidebar.appendChild(item);
				});
			});
	</script>
</body>
</html>
